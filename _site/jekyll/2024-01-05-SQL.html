<!DOCTYPE HTML>
<html lang="en" >
    <head><meta charset="UTF-8">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"><title>SQL · Kartik&#39;s Notebook</title><meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="description" content="Offload the brain.
"><meta name="generator" content="Jekyll (using style of GitBook 3.2.3)"><meta name="author" content="Kartik Pradeepan"><link rel="stylesheet" href="/assets/gitbook/style.css">
<link rel="stylesheet" href="/assets/gitbook/gitbook-plugin-fontsettings/website.css">
<link rel="stylesheet" href="/assets/gitbook/gitbook-plugin-search-pro/search.css">
<link rel="stylesheet" href="/assets/gitbook/gitbook-plugin-back-to-top-button/plugin.css">

<link rel="stylesheet" href="/assets/gitbook/rouge/colorful.css">

<link rel="stylesheet" href="/assets/gitbook/custom.css">
<link rel="stylesheet" href="/assets/gitbook/custom-local.css">

<meta name="HandheldFriendly" content="true"/>
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="/assets/gitbook/images/apple-touch-icon-precomposed-152.png">
<link rel="shortcut icon" href="//assets/gitbook/images/favicon.ico" type="image/x-icon">




            <link rel="prev" href="/" />
        

        
    </head>
    <body>
        <div class="book"><div class="book-summary">
    <script type="text/javascript">
        // Fixes the page links scroll problem on both desktop and mobile browsers
        function pageScrollToTop(element) {
            // both mobile and non-mobile
            $('div.body-inner').animate({scrollTop: 0});
            $(element).parent().find('li>ul>li').removeClass('active');
            return true;  // propagate
        }
        // Fixes the anchor links scroll problem on mobile browsers
        function mobilePageScrollToAnchor(element) {
            $(element).closest('li.chapter').find('ul>li').removeClass('active');
            $(element).parent().addClass('active');
            if ($(document).width() <= 1240) {
                $('div.body-inner').animate({scrollTop: $($(element).attr('href')).get(0).offsetTop});
            }
            return true;
        }
    </script>

    <nav role="navigation">
        <div id="book-search-input" role="search">
            <input type="text" placeholder="Type to search" />
        </div>
        <div id="book-search-input-link" role="search">
            <a href="/assets/search.html">Click to Search</a>
        </div>
        <ul class="summary">
            
            <li class="chapter" data-level="1.1" data-path="">
            
                <a href="/" onclick="pageScrollToTop(this)">
                    Kartik&#39;s Notebook
                </a>
            </li>

            <li class="divider"></li>

            
                <!-- <p>pages</p> -->
                
                    

                    
                        
                        <li class="chapter" data-level="1.1" data-path="/pages/about/">
                        
                            <a href="/pages/about/" onclick="pageScrollToTop(this)">
                                About
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/pages/contact/">
                        
                            <a href="/pages/contact/" onclick="pageScrollToTop(this)">
                                Contact
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/pages/design/draft/">
                        
                            <a href="/pages/design/draft/" onclick="pageScrollToTop(this)">
                                Design Draft
                            </a>
                            
                                
                            
                        </li>
                    

                    
                        <li class="divider"></li>
                    
                
            
                <!-- <p>posts</p> -->
                
                    

                    
                        
                        <li class="chapter active" data-level="1.2" data-path="/jekyll/2024-01-05-SQL.html">
                        
                            <a href="/jekyll/2024-01-05-SQL.html" onclick="pageScrollToTop(this)">
                                SQL
                            </a>
                            
                                
                                    <ul><li><a href="#1-selecting-and-retrieving-data-with-sql" onclick="mobilePageScrollToAnchor(this)" >1 Selecting and Retrieving Data with SQL</a><ul><li><a href="#11-what-is-sql" onclick="mobilePageScrollToAnchor(this)" >1.1 What is SQL?</a></li><li><a href="#12-data-models" onclick="mobilePageScrollToAnchor(this)" >1.2 Data Models</a></li><li><a href="#13-retrieving-data-with-a-select-statement" onclick="mobilePageScrollToAnchor(this)" >1.3 Retrieving data with a SELECT statement</a></li><li><a href="#14-creating-tables" onclick="mobilePageScrollToAnchor(this)" >1.4 Creating tables</a><ul><li><a href="#141-nulls-and-primary-keys" onclick="mobilePageScrollToAnchor(this)" >1.4.1 Nulls and primary keys</a></li><li><a href="#142-adding-data-to-the-table" onclick="mobilePageScrollToAnchor(this)" >1.4.2 Adding data to the table</a></li><li><a href="#143-creating-temporary-tables" onclick="mobilePageScrollToAnchor(this)" >1.4.3 Creating temporary tables</a></li><li><a href="#144-adding-comments-to-sql" onclick="mobilePageScrollToAnchor(this)" >1.4.4 Adding comments to SQL</a></li></ul></li><li><a href="#15-star-schema-vs-snowflake-schema" onclick="mobilePageScrollToAnchor(this)" >1.5 Star Schema vs Snowflake Schema</a><ul><li><a href="#151-first-difference-normalization" onclick="mobilePageScrollToAnchor(this)" >1.5.1 First difference: Normalization</a></li><li><a href="#152-second-difference-query-complexity" onclick="mobilePageScrollToAnchor(this)" >1.5.2 Second difference: Query complexity</a></li></ul></li></ul></li><li><a href="#2-filtering-sorting-and-calculating-data-with-sql" onclick="mobilePageScrollToAnchor(this)" >2 Filtering, Sorting, and Calculating Data with SQL</a><ul><li><a href="#21-basics-of-filtering-with-sql" onclick="mobilePageScrollToAnchor(this)" >2.1 Basics of Filtering with SQL</a><ul><li><a href="#211-where-clause-operator" onclick="mobilePageScrollToAnchor(this)" >2.1.1 WHERE clause operator</a></li></ul></li><li><a href="#22-advanced-filtering-in-or-not" onclick="mobilePageScrollToAnchor(this)" >2.2 Advanced Filtering: IN, OR, NOT</a><ul><li><a href="#221-in-operator" onclick="mobilePageScrollToAnchor(this)" >2.2.1 IN operator</a></li><li><a href="#222-or-operator" onclick="mobilePageScrollToAnchor(this)" >2.2.2 OR operator</a></li><li><a href="#223-in-vs-or" onclick="mobilePageScrollToAnchor(this)" >2.2.3 IN vs OR</a></li><li><a href="#224-order-with-and" onclick="mobilePageScrollToAnchor(this)" >2.2.4 ORDER with AND</a></li><li><a href="#225-not-operator" onclick="mobilePageScrollToAnchor(this)" >2.2.5 NOT operator</a></li></ul></li><li><a href="#23-using-wildcards-in-sql" onclick="mobilePageScrollToAnchor(this)" >2.3 Using Wildcards in SQL</a><ul><li><a href="#231-percent--wildcard" onclick="mobilePageScrollToAnchor(this)" >2.3.1 Percent (%) wildcard</a></li><li><a href="#232-underscore-_-wildcard" onclick="mobilePageScrollToAnchor(this)" >2.3.2 Underscore (_) wildcard</a></li><li><a href="#233-bracket--wildcard" onclick="mobilePageScrollToAnchor(this)" >2.3.3 Bracket [] wildcard</a></li><li><a href="#234-downsides-of-wildcards" onclick="mobilePageScrollToAnchor(this)" >2.3.4 Downsides of wildcards</a></li></ul></li><li><a href="#24-sorting-with-order-by" onclick="mobilePageScrollToAnchor(this)" >2.4 Sorting with ORDER BY</a><ul><li><a href="#241-rules-for-order-by" onclick="mobilePageScrollToAnchor(this)" >2.4.1 Rules for ORDER BY</a></li><li><a href="#242-sorting-by-column-position" onclick="mobilePageScrollToAnchor(this)" >2.4.2 Sorting by column position</a></li><li><a href="#243-sort-direction" onclick="mobilePageScrollToAnchor(this)" >2.4.3 Sort direction</a></li></ul></li><li><a href="#25-math-operations" onclick="mobilePageScrollToAnchor(this)" >2.5 Math operations</a><ul><li><a href="#251-order-of-operations" onclick="mobilePageScrollToAnchor(this)" >2.5.1 Order of operations</a></li><li><a href="#252-combining-math-operations" onclick="mobilePageScrollToAnchor(this)" >2.5.2 Combining math operations</a></li></ul></li><li><a href="#26-aggregate-functions" onclick="mobilePageScrollToAnchor(this)" >2.6 Aggregate functions</a><ul><li><a href="#261-using-distinct-on-aggregate-functions" onclick="mobilePageScrollToAnchor(this)" >2.6.1 Using DISTINCT on Aggregate functions</a></li></ul></li><li><a href="#27-grouping-data-with-sql" onclick="mobilePageScrollToAnchor(this)" >2.7 Grouping data with SQL</a><ul><li><a href="#271-grouping-data" onclick="mobilePageScrollToAnchor(this)" >2.7.1 Grouping data</a></li><li><a href="#272-having-clause---filtering-for-groups" onclick="mobilePageScrollToAnchor(this)" >2.7.2 HAVING Clause - Filtering for groups</a></li><li><a href="#273-where-vs-having" onclick="mobilePageScrollToAnchor(this)" >2.7.3 WHERE vs. HAVING</a></li><li><a href="#274-order-by-with-group-by" onclick="mobilePageScrollToAnchor(this)" >2.7.4 ORDER BY with GROUP BY</a></li></ul></li></ul></li><li><a href="#3-subqueries-and-joins-in-sql" onclick="mobilePageScrollToAnchor(this)" >3 Subqueries and Joins in SQL</a><ul><li><a href="#31-using-subqueries" onclick="mobilePageScrollToAnchor(this)" >3.1 Using Subqueries</a></li><li><a href="#32-subquery-best-practices-and-considerations" onclick="mobilePageScrollToAnchor(this)" >3.2 Subquery best practices and considerations</a><ul><li><a href="#321-subqueries-for-calculations" onclick="mobilePageScrollToAnchor(this)" >3.2.1 Subqueries for calculations</a></li></ul></li><li><a href="#33-joining-tables-an-introduction" onclick="mobilePageScrollToAnchor(this)" >3.3 Joining tables: An introduction</a><ul><li><a href="#331-joins" onclick="mobilePageScrollToAnchor(this)" >3.3.1 Joins</a></li></ul></li><li><a href="#34-cartesian-cross-joins" onclick="mobilePageScrollToAnchor(this)" >3.4 Cartesian (Cross) Joins</a></li><li><a href="#35-inner-joins" onclick="mobilePageScrollToAnchor(this)" >3.5 Inner joins</a></li><li><a href="#36-aliases-and-self-joins" onclick="mobilePageScrollToAnchor(this)" >3.6 Aliases and self joins</a><ul><li><a href="#361-aliases" onclick="mobilePageScrollToAnchor(this)" >3.6.1 Aliases</a></li><li><a href="#362-self-joins" onclick="mobilePageScrollToAnchor(this)" >3.6.2 Self joins</a></li></ul></li><li><a href="#37-advanced-joins-left-right-and-full-outer-joins" onclick="mobilePageScrollToAnchor(this)" >3.7 Advanced Joins: left, right, and full outer joins</a><ul><li><a href="#371-left-joins" onclick="mobilePageScrollToAnchor(this)" >3.7.1 Left Joins</a></li><li><a href="#372-right-joins" onclick="mobilePageScrollToAnchor(this)" >3.7.2 Right Joins</a></li><li><a href="#373-difference-between-right-and-left" onclick="mobilePageScrollToAnchor(this)" >3.7.3 Difference between right and left</a></li><li><a href="#374-full-outer-joins" onclick="mobilePageScrollToAnchor(this)" >3.7.4 Full Outer Joins</a></li></ul></li><li><a href="#38-unions" onclick="mobilePageScrollToAnchor(this)" >3.8 Unions</a><ul><li><a href="#381-union-vs-union-all" onclick="mobilePageScrollToAnchor(this)" >3.8.1 Union vs Union All</a></li></ul></li></ul></li><li><a href="#4-modifying-and-analyzing-data-with-sql" onclick="mobilePageScrollToAnchor(this)" >4 Modifying and Analyzing Data with SQL</a><ul><li><a href="#41-working-with-text-strings" onclick="mobilePageScrollToAnchor(this)" >4.1 Working with text strings</a></li></ul></li></ul>

                                
                            
                        </li>
                    

                    
                        <li class="divider"></li>
                    
                
            
        </ul>
    </nav>
</div>
<div class="book-body">
                <div class="book-header" role="navigation">
                    <!-- Title -->
                    <h1>
                        <i class="fa fa-circle-o-notch fa-spin"></i>
                        
                            <a href="." >SQL</a>
                        
                    </h1>
                </div>

                <div class="body-inner"><div class="page-wrapper" tabindex="-1" role="main">
    

    <div class="page-inner">
        <div id="book-search-results">
            <div class="search-noresults">
                <section class="normal markdown-section">
                    
                        <h1 id="/jekyll/SQL">SQL</h1>
                    

                    <h1 id="1-selecting-and-retrieving-data-with-sql">1 Selecting and Retrieving Data with SQL</h1>

<h2 id="11-what-is-sql">1.1 What is SQL?</h2>
<p>Structured Query Language (SQL): standard computer language for data management and data manipulation. It is the way you can communicate with databases. It is a non-procedural language, meaning you cannot write complete applications with it however you will be able to read, write, and update data.</p>

<p>Just because SQL is the language you are using, there are differences in the syntax depending on the database management system (DBMS) you are using.</p>

<h2 id="12-data-models">1.2 Data Models</h2>
<p>Databases: a container to store organized data; a set of related information.</p>

<p>Tables: a structured list of data or a specific type.</p>
<ul>
  <li>Columns: a single field in a table</li>
  <li>Rows: a record in a table</li>
</ul>

<p>What is data modelling? Organizes and structures information into multiple, related tables. Can represent a business process or show relationships between business processes. <em>Data models should closely represent the real world processes</em></p>

<p>NoSQL (not only SQL): a mechanism for storage and retrieval of unstructured data modelled by means other than tabular relations in relational databases.</p>

<p>All relational models have an entity, attribute, and relationship.</p>
<ul>
  <li>Entity: person, place, thing, or event. Distinguishable, unique and distinct.</li>
  <li>Attribute: characterstic of an entity.</li>
  <li>Relationship: describes association among entities (e.g., one-to-many, many-to-many, one-to-one)</li>
</ul>

<p>ER diagrams depict the relationships between tables. Helps represent business processes. Joined by primary-foreign keys.</p>
<ul>
  <li>Primary keys: a column (or set of columns) whose values uniquely identify every row in a table.</li>
  <li>Foriegn key: one or more columns that can be used together to identify a single row in another table.</li>
  <li>Different types of notation (Chen Notation, Crow’s Foot Notation, UML Class Diagram Notation)</li>
</ul>

<h2 id="13-retrieving-data-with-a-select-statement">1.3 Retrieving data with a SELECT statement</h2>

<p>The select statement you need to specific what you want and where you want it from.</p>

<pre><code class="language-SQL">SELECT item1,
        item2,
        item3
FROM tableName;
</code></pre>
<p>Selects items 1-3 from tableName.</p>

<pre><code class="language-SQL">SELECT *
FROM tableName;
</code></pre>
<p>Selects all items from tableName.</p>

<p>A lot of times you want to limit results (e.g., when the database is large). To select a sample from the database.</p>

<pre><code class="language-SQL">SELECT columnsYouWantToSee
FROM tableName
LIMIT 5;
</code></pre>
<p>Will show you the first 5 columns you want to see from tableName.</p>

<p>*Note: LIMITS have different syntaxes across DBMS.</p>

<h2 id="14-creating-tables">1.4 Creating tables</h2>

<p>Creating tables is useful if you want to extract data from other sources.</p>

<pre><code class="language-SQL">CREATE TABLE tableName (
    Id   char(10)    PRIMARY KEY,
    Variable1   char(10)    NOT NULL,
    Variable2   char(250)   NOT NULL,
    Variable3   decimal(8,2)  NOT NULL,
    Variable4   Varchar(750)    NULL
);
</code></pre>
<h3 id="141-nulls-and-primary-keys">1.4.1 Nulls and primary keys</h3>
<p>Every column is either NULL or NOT NULL. You will receive an error if you omit this with no value. *Note: Do not confuse null values with empty strings**. Primary keys cannot be null.</p>

<p>Primary keys MUST have a value.</p>

<h3 id="142-adding-data-to-the-table">1.4.2 Adding data to the table</h3>
<p>Two ways described below.</p>

<pre><code class="language-SQL">INSERT INTO tableName
VALUES ('000001', 
    'StringValue1', 
    'Stringvalue2', 
    '10.45', 
    NULL
    );
</code></pre>
<p>Using INSERT. This is not a recommended way because you are manually inserting values into columns and if you mess up the order, the entry will be wrong.</p>

<pre><code class="language-SQL">INSERT INTO tableName (
    Id, 
    Variable1, 
    Variable2, 
    Variable3, 
    Variable4
    )
VALUES (
    '000001', 
    'StringValue1', 
    'Stringvalue2', 
    '10.45', 
    NULL
    );
</code></pre>
<p>Now you are guaranteeing that the values are going into the right column.</p>

<h3 id="143-creating-temporary-tables">1.4.3 Creating temporary tables</h3>
<p>Temporary tables will be deleted when the current session is terminated. Faster than creating a real table. Useful for complex queries using subsets and joints.</p>

<pre><code class="language-SQL">CREATE TEMPORARY TABLE tmpTableName AS (
    SELECT *
    FROM tableName
    WHERE variableName1 = "conditionalString"
);
</code></pre>
<p>Depending on the DBMS, you will not be able to write data to temporary tables.</p>

<h3 id="144-adding-comments-to-sql">1.4.4 Adding comments to SQL</h3>
<p>Mutes the expression of code. Also helps you remember what and why you were doing.</p>

<p>Two ways to add comments</p>

<p>Single line comments</p>
<pre><code class="language-SQL">SELECT variableName1,
--variableName2,
variableName3
from tableName
</code></pre>
<p>The above comments out variableName2.</p>

<p>Section comments</p>
<pre><code class="language-SQL">SELECT variableName1,
/* variableName2,
variableName3 */
from tableName
</code></pre>
<p>The above comments out variableName2, and variableName3.</p>

<h2 id="15-star-schema-vs-snowflake-schema">1.5 Star Schema vs Snowflake Schema</h2>

<p>These are two types of datawarehouse models. They are ways to organize data using relational databases.</p>

<p>Star schema: Aggregated central fact table that contains relationships to dimension tables.</p>

<p>Snowflake schema: Stores the same data as the star schema however the main difference is that the dimensional tables in the snowflake schema are normalized producing <em>snowflaking</em>.</p>

<h3 id="151-first-difference-normalization">1.5.1 First difference: Normalization</h3>

<p>Snowflake schemas will use less space to store dimension tables because normalized databases produce far fewer redundant records. As a result of this, denormalized data models increase the chance of data integrity issues where records across dimension tables start to vary.</p>

<h3 id="152-second-difference-query-complexity">1.5.2 Second difference: Query complexity</h3>

<p>Snowflake schemas, because the dimension tables are normalized, require more complex querying. In star schema, you will only join the fact table with dimension tables you need - you will only have one JOIN per dimension table. In snowflake schema querying, you will need to use multiple joins to find the right dimension. Because of this, querying takes slightly longer in snowflake schema however the absolute difference is meaningless (e.g., 1ms vs 1s).</p>

<p><a href="https://www.vertabelo.com/blog/data-warehouse-modeling-star-schema-vs-snowflake-schema/">Source for snowflake vs star schema</a></p>

<h1 id="2-filtering-sorting-and-calculating-data-with-sql">2 Filtering, Sorting, and Calculating Data with SQL</h1>

<h2 id="21-basics-of-filtering-with-sql">2.1 Basics of Filtering with SQL</h2>

<p>Allows you to narrow the data you want to retrieve, reduce the number of records you retrieve, increase query performance, reduce the strain on the client application, and governance limitations.</p>

<h3 id="211-where-clause-operator">2.1.1 WHERE clause operator</h3>
<pre><code class="language-SQL">SELECT *
FROM tableName
WHERE columnName operator value;
</code></pre>

<p>List of operators:</p>
<ol>
  <li><code class="language-plaintext highlighter-rouge">=</code> equal</li>
  <li><code class="language-plaintext highlighter-rouge">&lt;&gt;</code> not equal (in some operators it may be written as !=)</li>
  <li><code class="language-plaintext highlighter-rouge">&gt;</code> greater than</li>
  <li><code class="language-plaintext highlighter-rouge">&lt;</code> less than</li>
  <li><code class="language-plaintext highlighter-rouge">&gt;=</code> greater than or equal</li>
  <li><code class="language-plaintext highlighter-rouge">&lt;=</code> less than or equal to</li>
  <li><code class="language-plaintext highlighter-rouge">BETWEEN</code> between an inclusive range
    <ul>
      <li>You need to specific the range (e.g., WHERE columnName BETWEEN value1 AND value2;)</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">IS NULL</code> is a null value</li>
</ol>

<h2 id="22-advanced-filtering-in-or-not">2.2 Advanced Filtering: IN, OR, NOT</h2>

<h3 id="221-in-operator">2.2.1 IN operator</h3>
<p>Specifics a range of conditions. Comma deliminted list of values. Enclosed in ().</p>

<pre><code class="language-SQL">SELECT variableName
FROM tableName
WHERE variableName IN (value1, value2, value3)
</code></pre>

<h3 id="222-or-operator">2.2.2 OR operator</h3>

<p>DBMS will not evaluate the second conditions in a WHERE clause if the first condition is met. Use for any rows matching the specific conditions.</p>

<pre><code class="language-SQL">SELECT variableName
FROM tableName
WHERE variableName = 'string1' OR 'string2';
</code></pre>

<h3 id="223-in-vs-or">2.2.3 IN vs OR</h3>

<p>In works the same as OR, however there are some benefits of IN</p>
<ul>
  <li>Long list of options</li>
  <li>IN executes faster than OR</li>
  <li>Don’t have to think about the order with IN</li>
  <li>Can contain another select</li>
</ul>

<h3 id="224-order-with-and">2.2.4 ORDER with AND</h3>

<p>SQL will process an AND before an OR, so you will need to include parathesis to specific the groups.</p>

<h3 id="225-not-operator">2.2.5 NOT operator</h3>

<p>A way to exclude certain variables.</p>

<pre><code class="language-SQL">SELECT *
FROM tableName
WHERE NOT variableName = 'string1' AND 
NOT variableName = 'string2';
</code></pre>

<h2 id="23-using-wildcards-in-sql">2.3 Using Wildcards in SQL</h2>

<h3 id="231-percent--wildcard">2.3.1 Percent (%) wildcard</h3>
<p>Wildcards: special character used to match parts of a value. Search pattern made from literal text, wildcard charracter, or a combination. Uses <code class="language-plaintext highlighter-rouge">LIKE</code> as an operator (though technically a predicate). Can only be used with strings and not non-text datatypes.</p>

<p>To use a wildcard, you use a <code class="language-plaintext highlighter-rouge">%</code> before, in the middle, and/or after the word.</p>

<p>Another way to use a wildcard is to put it between letters to produce a more dynamic search. (E.g., <code class="language-plaintext highlighter-rouge">t%@gmail.com</code> will grab gmail addresses that start with “t”).</p>

<p>% wildcars will not match null values. NULL represents no value in a column.</p>

<pre><code class="language-SQL">SELECT variableName1, variableName2
FROM tableName
WHERE variableName2 LIKE '%substring'
</code></pre>

<h3 id="232-underscore-_-wildcard">2.3.2 Underscore (_) wildcard</h3>

<p><code class="language-plaintext highlighter-rouge">_</code> will match a single character (however not supported in all DBMSs)</p>

<p>Instead of <code class="language-plaintext highlighter-rouge">%</code> which will match any length string, <code class="language-plaintext highlighter-rouge">_</code> will only match a single character.</p>

<h3 id="233-bracket--wildcard">2.3.3 Bracket [] wildcard</h3>

<p>Used to specific a set of characters in a specific location (also does not work with all DBMSs)</p>

<h3 id="234-downsides-of-wildcards">2.3.4 Downsides of wildcards</h3>

<p>Takes longer to run so better to use other operators. Statements with wildcards will take longer to run if used at the end of search patterns (so placement of wildcards is important).</p>

<h2 id="24-sorting-with-order-by">2.4 Sorting with ORDER BY</h2>

<p>Why sort data? Data displayed appears in the order of the underlying tables. Updated and deleted data can change this order. Sequence of retrieved data cannot be assumed if order was not specified? Sorting data logically helps keep information you want on top. <code class="language-plaintext highlighter-rouge">ORDER BY</code> clause allows user to sort data by particular columns</p>

<pre><code class="language-SQL">SELECT *
FROM tableName
ORDER BY variableName43
</code></pre>

<h3 id="241-rules-for-order-by">2.4.1 Rules for ORDER BY</h3>

<p>Takes the name of one or more columns. Add a comma after each additional column name. You can sort by a column not retrieved (in the original SELECT statement). Must always be the last clause in a select statement.</p>

<h3 id="242-sorting-by-column-position">2.4.2 Sorting by column position</h3>

<pre><code class="language-SQL">ORDER BY 2,3
</code></pre>
<p>Will sort by column position where 2 means 2nd column, and 3 means 3rd column, etc.</p>

<h3 id="243-sort-direction">2.4.3 Sort direction</h3>

<p><code class="language-plaintext highlighter-rouge">DESC</code> for descending order</p>

<p><code class="language-plaintext highlighter-rouge">ASC</code> for ascending order</p>

<p>Only applies to the column names it directly precedes.</p>

<h2 id="25-math-operations">2.5 Math operations</h2>
<p><code class="language-plaintext highlighter-rouge">+</code>, <code class="language-plaintext highlighter-rouge">-</code>, <code class="language-plaintext highlighter-rouge">*</code>, <code class="language-plaintext highlighter-rouge">/</code></p>

<pre><code class="language-SQL">SELECT variableName1, 
    variableName2, 
    variableName3 * variableName1 AS variableName4
FROM tableName
</code></pre>

<p>Creates a new column based on the math operation between variable1 and variable3.</p>

<h3 id="251-order-of-operations">2.5.1 Order of operations</h3>

<p>Parantheses, exponents, multiplication, division, addition, substraction</p>

<h3 id="252-combining-math-operations">2.5.2 Combining math operations</h3>

<pre><code class="language-SQL">SELECT variableName1, 
    variableName2, 
    variableName3
    (variableName4 - variableName3) * variableName1 AS variableName5
FROM tableName
</code></pre>

<h2 id="26-aggregate-functions">2.6 Aggregate functions</h2>

<p>Provide various ways to summarize data. Useful for finding highest/lowest values, total number of rows, or average values.</p>

<p><code class="language-plaintext highlighter-rouge">AVG()</code> averages a column of values<br />
<code class="language-plaintext highlighter-rouge">COUNT()</code> counts the number of values<br />
<code class="language-plaintext highlighter-rouge">MIN()</code> finds the minimum value<br />
<code class="language-plaintext highlighter-rouge">MAX()</code> finds the maximum value<br />
<code class="language-plaintext highlighter-rouge">SUM()</code> sums the column value</p>

<pre><code class="language-SQL">SELECT AVG(variableName) AS variableNameAlias
FROM tableName
</code></pre>

<p>Rows containing null values will be ignored.</p>

<p><code class="language-plaintext highlighter-rouge">COUNT(*)</code> will count all the rows in a table containing values or NULL values</p>

<p><code class="language-plaintext highlighter-rouge">COUNT(variableName)</code> will count all rows in a specific column while ignoring NULL values</p>

<pre><code class="language-SQL">SELECT MIN(variableName) as min_value,
    MAX(variableName) as max_value
FROM tableName
</code></pre>
<p>MIN/MAX will ignore null values</p>

<pre><code class="language-SQL">SELECT SUM(variableName1*variableName2) AS variableNameAlias
FROM tableName
WHERE variableName3 = 'valueID';
</code></pre>

<p>Will do math operations on data that matches condition and store the new value as a new column.</p>

<h3 id="261-using-distinct-on-aggregate-functions">2.6.1 Using DISTINCT on Aggregate functions</h3>

<p>If DISTINCT is not specified, ALL is assumed. Cannot use DISTINCT on COUNT(*). No value to use with MIN and MAX functions.</p>

<pre><code class="language-SQL">SELECT COUNT(DISTINCT variableName)
FROM tableName
</code></pre>

<h2 id="27-grouping-data-with-sql">2.7 Grouping data with SQL</h2>

<h3 id="271-grouping-data">2.7.1 Grouping data</h3>

<pre><code class="language-SQL">SELECT variableName1,
    COUNT(variableName2) AS variableName3
FROM tableName
GROUP BY variableName1
</code></pre>
<p>if you did not have the group by, it would count the whole table.</p>

<p>GROUP BY clauses can contain multiple columns.</p>

<p>Every column in your SELECT statement MUST be present in a GROUP BY clause, except for the aggregated calculations.</p>

<p>NULLs will be grouped together if your GROUP BY column contain NULLs.</p>

<h3 id="272-having-clause---filtering-for-groups">2.7.2 HAVING Clause - Filtering for groups</h3>

<p>WHERE does not work for groups. WHERE filters on rows. Instead, use HAVING clause to filter for groups.</p>

<pre><code class="language-SQL">SELECT variableName1,
    COUNT (*) AS variableName2
FROM tableName
GROUP BY variableName1
HAVING COUNT (*) &gt;= 2;
</code></pre>
<p>Counts variableName1 that had more than 2 of variableName2.</p>

<h3 id="273-where-vs-having">2.7.3 WHERE vs. HAVING</h3>

<p>WHERE filters before data is grouped.</p>

<p>HAVING filters after data is grouped.</p>

<p>Rows eliminated by the WHERE clause will not be a included in the group.</p>

<h3 id="274-order-by-with-group-by">2.7.4 ORDER BY with GROUP BY</h3>

<p>ORDER BY sorts data.</p>

<p>GROUP BY does not sorta data.</p>

<h1 id="3-subqueries-and-joins-in-sql">3 Subqueries and Joins in SQL</h1>

<h2 id="31-using-subqueries">3.1 Using Subqueries</h2>

<p>Subqueries: Queries embedded in other queries. Relational databases store data across multiple tables. Subqueries merge data from multiple sources together. Helps with adding other filtering criteria.</p>

<pre><code class="language-SQL">SELECT CustomerID, 
    CompanyName, 
    Region
FROM Customers
WHERE CustomerID in (SELECT customerID
    FROM Orders
    WHERE Freight &gt; 100);
</code></pre>
<p>Example from Coursera. In the above example, we queried the Orders table to get customerID with Freight over 100 to look up their CompanyName and Region. We used subquering to filter one table to retrieve data from another.</p>

<p>The query will always perform the innermost SELECT portion first.</p>

<h2 id="32-subquery-best-practices-and-considerations">3.2 Subquery best practices and considerations</h2>

<p>There is no limit to the number of subqueries you can have. Performance slows when you nest too deeply.</p>

<p><strong>Subquery selects can only retrieve a single column</strong></p>

<p>Properly indent subqueries to know where each SELECT statement starts and ends.
<a href="www.poorsql.com">www.poorsql.com</a> will reformat code with proper indenting.</p>

<h3 id="321-subqueries-for-calculations">3.2.1 Subqueries for calculations</h3>

<pre><code class="language-SQL">SELECT customer_name,
    customer_state
    (SELECT COUNT(*) AS orders
    FROM Orders
    WHERE Orders.customer_id = Customer.customer_id) AS orders
FROM customers
ORDER BY Customer_name
</code></pre>
<p>The subquery is enclosed in the brackets. Retrieves the total number of orders placed by each customer.</p>

<h2 id="33-joining-tables-an-introduction">3.3 Joining tables: An introduction</h2>

<p>The reasons why we break data into multiple tables</p>
<ol>
  <li>Efficient storage</li>
  <li>Easier manipulations</li>
  <li>Greater scalability</li>
  <li>Logically models a process</li>
  <li>Tables are related through common values (i.e., keys)</li>
</ol>

<h3 id="331-joins">3.3.1 Joins</h3>

<p>Associates correct records from each table on the fly. Allows data retrieval from multiple tables in one query. Joins are not physical - they persist for the duration of the query execution.</p>

<h2 id="34-cartesian-cross-joins">3.4 Cartesian (Cross) Joins</h2>

<p>What is a Cartesian (Cross) join? Each row from the first table joins with all the rows of another table.</p>
<ul>
  <li>Computational expensive (e.g., a table with x rows and another with y rows will produce a new table of x * y rows)</li>
</ul>

<pre><code class="language-SQL">SELECT variableName1,
    variableName2,
    variableName3
FROM tableName1 CROSS JOIN tableName2;
</code></pre>

<p>This is a simple join that you can do, <strong>but it does not match anything</strong>. Therefore, it will return products with the incorrect information (therefore, it is not frequently used).</p>

<h2 id="35-inner-joins">3.5 Inner joins</h2>

<p>Inner joins: used to select records that have matching values (usually by keys) in both tables.</p>

<pre><code class="language-SQL">SELECT variableName1,
    variableName2,
    variableName3
FROM tableName1 INNER JOIN tableName2
ON tableName1.keyName = tableName2.keyName;
</code></pre>
<p>NOTE: If you have a common variableName that is found in both tables, you need to prequalify the variableName (that is a column name) with the table Name. E.g., <code class="language-plaintext highlighter-rouge">SELECT tableName1.variableName1,</code> if variableName1 is found in both.</p>

<p>You can perform on multiple tables. But becareful not to overly join because they are computationally taxing.</p>

<pre><code class="language-SQL">SELECT a.variableName1,
    b.variableName2,
    c.variableName3
FROM (
        (
        tableName1 a INNER JOIN tableName2 b ON a.keyName = b.keyName
        )
        INNER JOIN tableName3 c ON a.keyName = c.keyName
    );
</code></pre>

<p>Be as specific which table a column is from.</p>

<h2 id="36-aliases-and-self-joins">3.6 Aliases and self joins</h2>

<h3 id="361-aliases">3.6.1 Aliases</h3>
<p>Alias: shortens a table or a column with a temporary name. Makes it more readable and does not physically change the table/column name.</p>

<pre><code class="language-SQL">SELECT variableName1, 
    variableName2
FROM tableName1 as t1, 
    and tableName2 as t2
WHERE t1.keyName = t2.keyName;
</code></pre>

<h3 id="362-self-joins">3.6.2 Self joins</h3>
<p>When you join a table to itself.</p>

<pre><code class="language-SQL">SELECT t1.variableName1 as name1, 
    t2.variableName1 as name2,
    t1.variableName2
FROM tableName1 t1,
    tableName2 t2
WHERE t1.keyName = t2.keyName
    AND t1.variableName2 = t2.variableName2
ORDER BY t1.variableName2
</code></pre>

<p>The following matches variableName1 that have the same variableName2.</p>

<h2 id="37-advanced-joins-left-right-and-full-outer-joins">3.7 Advanced Joins: left, right, and full outer joins</h2>

<h3 id="371-left-joins">3.7.1 Left Joins</h3>
<p>Returns all records from the left table (table1) and the matched records from the right table (table2).</p>

<p>The result is NULL from the right side, if there is no match.</p>

<p>E.g., if Table1 is a customers table and Table2 is an orders table. A left join would produce a new table with all the customers and their associated order information (or null if no order).</p>

<pre><code class="language-SQL">SELECT C.CustomerName, 
    O.OrderID
FROM Customers C
LEFT JOIN Orders O ON C.CustomerID = O.CustomerID
ORDER BY C.CustomerName;
</code></pre>

<h3 id="372-right-joins">3.7.2 Right Joins</h3>
<p>Returns all records from the right table (table2) and the matched records from left table (table1).</p>

<p>The result is NULL from the left side, when there is no match.</p>

<p>E.g., if Table1 is a employees table and Table2 is an orders table. A right join would produce a new table with all the orders and the employees associated with the orders.</p>

<pre><code class="language-SQL">SELECT O.OrderID, 
    E.LastName, 
    E.FirstName
FROM Orders O
RIGHT JOIN Employees E ON O.EmployeeID = E.EmployeeID
ORDER BY O.OrderID;
</code></pre>

<h3 id="373-difference-between-right-and-left">3.7.3 Difference between right and left</h3>
<p>If you switch the order of when the tables appear, a left join can be turned into right joins and vice versa.</p>

<h3 id="374-full-outer-joins">3.7.4 Full Outer Joins</h3>
<p>Returns all records when there is a match in either left (table1) or right (table2) table records.</p>

<p>Gives you everything.</p>

<pre><code class="language-SQL">SELECT C.CustomerName,
    O.OrderID
FROM Customers C
FULL OUTER JOIN Orders O ON C.CustomerID=O.CustomerID
ORDER BY C.CustomerName;
</code></pre>

<h2 id="38-unions">3.8 Unions</h2>
<p>The UNION operator is used to combine the result-set of two or more SELECT statements. Each SELECT statement within UNION must have the same number of columns. Columns MUST have similar data types. The columns in each SELECT statement MUST be in the same order.</p>

<p>Sort of like appending two tables on top of each other.</p>

<pre><code class="language-SQL">SELECT variableName(s)
FROM tableName1
UNION
SELECT variableName(s)
FROM tableName2;
</code></pre>

<pre><code class="language-SQL">SELECT variableName1, 
    variableName2
FROM tableName1
WHERE variableName2='someString'
UNION
SELECT variableName1, 
    variableName2
FROM tableName2
WHERE variableName2='someString'
ORDER BY variableName1
</code></pre>

<h3 id="381-union-vs-union-all">3.8.1 Union vs Union All</h3>

<p>The UNION command is used to select related information from two tables, much like the JOIN command. However, when using the UNION command all selected columns need to be of the same data type. With UNION, only distinct values are selected.</p>

<p>The UNION ALL command is equal to the UNION command, except that UNION ALL selects all values.</p>

<p>The difference between Union and Union all is that Union all will not eliminate duplicate rows, instead it just pulls all rows from all tables fitting your query specifics and combines them into a table.</p>

<p><a href="https://blog.sqlauthority.com/2009/03/11/sql-server-difference-between-union-vs-union-all-optimal-performance-comparison/">From SQL Authority</a></p>

<h1 id="4-modifying-and-analyzing-data-with-sql">4 Modifying and Analyzing Data with SQL</h1>

<h2 id="41-working-with-text-strings">4.1 Working with text strings</h2>
</section>
            </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div></div>
    </div>
</div>

<!-- introduce mathjax support -->
<script>
window.MathJax = {
  tex: {
    inlineMath: [ ['$', '$'], ['\\(', '\\)'] ]
  },
  svg: {
    fontCache: 'global'
  }
};
</script>
<script
  type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>


<!-- introduce per-page mermaid support -->


<!-- introduce mathjax support -->
<script>
    function fixes_chrome_anchors() {
        let chrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);
        if (window.location.hash && chrome) {
            setTimeout(function () {
                var hash = window.location.hash;
                window.location.hash = "";
                window.location.hash = hash;
            }, 300);
        }
    }

    if (document.readyState === "loading") {
        // Loading hasn't finished yet
        document.addEventListener("DOMContentLoaded", fixes_chrome_anchors);
    } else {
        // `DOMContentLoaded` has already fired
        fixes_chrome_anchors();
    }
</script>


                        <a href="/" class="navigation navigation-prev navigation-unique" aria-label="Previous page: Kartik's Notebook">
                            <i class="fa fa-angle-left"></i>
                        </a>
                    

                    
                </div>
            </div>

            <script>
            var gitbook = gitbook || [];
            gitbook.push(function() {
                gitbook.page.hasChanged({
    "page": {
        "title": "Introduction",
        "level": "1.1",
        "depth": 1,
        
        "dir": "ltr"
    },    "config": {
        "plugins": ["fontsettings", "highlight", "livereload", "lunr", "search", "sharing", "theme-default", "livereload"],
        "styles": {
            "ebook": "styles/ebook.css",
            "epub": "styles/epub.css",
            "mobi": "styles/mobi.css",
            "pdf": "styles/pdf.css",
            "print": "styles/print.css",
            "website": "styles/website.css"
        },
        "pluginsConfig": {
            "fontsettings": {
                "family": "sans",
                "size": 2,
                "theme": "white"
            },
            "highlight": {},
            "livereload": {},
            "lunr": {
                "ignoreSpecialCharacters": false,
                "maxIndexSize": 1000000
            },
            "search": {},            "sharing": {
                "facebook": true,

                "google": false,

                "github": true,
              
                "github_link": "https://github.com",
              

                "telegram": false,
                "telegram_link": "https://t.me",

                "instapaper": false,

                "twitter": true,
              

                "vk": false,

                "weibo": false,

                "all": ["facebook", "google", "twitter", "weibo", "instapaper", "github", "telegram"]
            },
"theme-default": {
                "showLevel": false,
                "styles": {
                    "ebook": "styles/ebook.css",
                    "epub": "styles/epub.css",
                    "mobi": "styles/mobi.css",
                    "pdf": "styles/pdf.css",
                    "print": "styles/print.css",
                    "website": "styles/website.css"
                }
            }
        },
        "theme": "default",
        "author": "Tao He",
        "pdf": {
            "pageNumbers": true,
            "fontSize": 12,
            "fontFamily": "Arial",
            "paperSize": "a4",
            "chapterMark": "pagebreak",
            "pageBreaksBefore": "/",
            "margin": {
                "right": 62,
                "left": 62,
                "top": 56,
                "bottom": 56
            }
        },
        "structure": {
            "langs": "LANGS.md",
            "readme": "README.md",
        },
        "variables": {},
        "title": "Kartik's Notebook",
        "language": "en",
        "gitbook": "*"
    },
    "file": {
        "path": "_posts/2024-01-05-SQL.md",
        "mtime": "2024-01-05 00:00:00 -0500",
        "type": "markdown"
    },
    "gitbook": {
        "version": "3.2.3",
        "time": "2024-01-07 20:33:38 -0500"
    },
    "basePath": "",
    "book": {
        "language": ""
    }
});
            });
            </script>
        </div><script src="/assets/gitbook/gitbook.js"></script>
<script src="/assets/gitbook/theme.js"></script>

<script src="/assets/gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
<script src="/assets/gitbook/gitbook-plugin-sharing/buttons.js"></script>

<!-- <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
<script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
<script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
<script src="../gitbook/gitbook-plugin-search/search.js"></script> -->

<script src="/assets/gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
<script src="/assets/gitbook/gitbook-plugin-search-pro/search.js"></script>
<script src="/assets/gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
<script src="/assets/gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>

</body>
</html>